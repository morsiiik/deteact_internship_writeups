## LOGIC WRITEUP

### 1. Top Shop V1

Перехватив запрос покупки cheap thing, можно увидеть что в путь /buy передается три параметра:
sign, price и id. sign представляет собой md5 хеш, расшифровав который получим комбинацию для хеширования `secret310` (secret+id+price).
Сформируем собственный sign, подменив price для флага: `md5(secret110)` , и купим флаг.

`deteact{ecf441ba2d26b3caa1ead0daf2ce3ac3}`

### 2. Top Shop V2

При каждой покупке есть возможность получить кешбек. В параметрах кешбека передается параметр валюты
и id транзакции.

Сначала я попробовал пробежаться по всем транзакциям и собрать с них кешбек с burp intruder (транзакций было около 7 тысяч), но удалось собрать только 25000)

Сгенерировав несколько транзакций изменим значение валюты на ту, у которой большой курс к EUR. Я использовал PHP.
Получив увеличенный кешбек с транзакций, сможем купить флаг.

`deteact{2ef7cc2ef4762f95f9808d2219f17010}`

### 3. Password Manager

Зарегистрировавшись, посмотрим сохраненные пароли. В запрос передается поле id, содержащее md5 хеш

`GET /?id=c81e728d9d4c2f636f067f89cc14862c`

Расшифровав хеш получим число, представляющее id пользователя в бд.
Заменим id на md5(1) и получим флаг

`deteact{0fc913374a315ae322310a6e08a3c6f6}`

### 4. Fast Application

Из приложенного кода увидим, что сначала файл загружается в /files, а после, перед его удалением
выполняется довольно долгая операция `$used = shell_exec('du -sh /');`
Напишем скрипт для обращения к файлу, и revese shell на php.
```
import requests

while True:
    r = requests.get('http://79.143.25.24:32504/files/shell.php')
    if r.status_code != 404:
        print(r.status_code)
        break
```

Запустим скрипт, и загрузим наш shell на машину. Код исполнится, получим коннект и внутри машины найдем флаг.

`deteact{365f537db238a2dbbd7141a4f3a30de4}`

### 5. BugBounty platform

Зарегистрировавшись увидим что каждому хакеру присваивается rating и rewards. Применив mass assignment при регистрации получим флаг.
`?username=aa&password=aa&rewards=99999&rating=99999`

`deteact{41c24ee8d9635323abcb9593ecd1209f}`

### 6. BugBounty platform 3

Зарегистрировавшись на сервере, увидим что cookie session представляет собой JWT токен, найдем его соль с помощью hashcat

`hashcat -a 0 -m 16500 eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFhIiwiaWF0IjoxNjgwNTM1NjI5fQ.HU30tRsiB1jfAkJFgXdzUso4TgIX9HQ3DEHGO_NX6nc dict.txt`

Получим secret key для jwt `1122334455`

на jwt.io сгенерируем JWT для имени admin, используя найденную соль. Залогинившись под админом на сервере найдем флаг.

`deteact{7fb5ef652f60edca8dbdbb698d0c7291}`


### 7. BugBounty platfrom 2

Переберем параметры при запросе на /private/4, где хранится репорт о "серьезной уязвимости". Param miner найдет параметр id
Передав ?id=1 (id нашего приватного поста), залогинившись под админом, прочитаем пост и получим флаг

`deteact{268f7a36b0ec88f86403335679907b07}`
